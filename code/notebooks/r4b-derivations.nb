(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83171,       2188]
NotebookOptionsPosition[     75669,       2044]
NotebookOutlinePosition[     76047,       2061]
CellTagsIndexPosition[     76004,       2058]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["R4B Equations of Motion ", "Section",
 CellChangeTimes->{{3.74391640898279*^9, 
  3.7439164151828814`*^9}},ExpressionUUID->"37893b91-afb7-49fa-ab58-\
be1f8a17b3ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Prevents", " ", "Mathematica", " ", "from", " ", "using", " ", "Sec"}], 
     "=", 
     RowBox[{"1", "/", "Cos"}]}], ",", " ", 
    RowBox[{"Csc", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "Sin"}], " ", "and", " ", "Cot"}], "=", 
      RowBox[{"1", "/", "Tan"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$PrePrint", "=", 
     RowBox[{
      RowBox[{"#", "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Csc", "[", "z_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"Defer", "@", 
            RowBox[{"Sin", "[", "z", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"Sec", "[", "z_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"Defer", "@", 
            RowBox[{"Cos", "[", "z", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"Cot", "[", "z_", "]"}], "\[RuleDelayed]", 
          RowBox[{"1", "/", 
           RowBox[{"Defer", "@", 
            RowBox[{"Tan", "[", "z", "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "}"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Remove", "[", "\"\<`*\>\"", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.743918544998918*^9, 3.743918576334177*^9}, {
  3.743918608430518*^9, 3.743918633397081*^9}, {3.7439322664672403`*^9, 
  3.743932289281768*^9}, {3.743934361479266*^9, 
  3.7439343688973703`*^9}},ExpressionUUID->"f54c1562-6c53-498d-a9d2-\
a2f3b5634afc"],

Cell[CellGroupData[{

Cell["Step 0: L", "Subsection",
 CellChangeTimes->{{3.743916452759317*^9, 
  3.74391646130881*^9}},ExpressionUUID->"86c655a9-5947-445f-aa9a-\
af524ee708d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    SubscriptBox["m", "s"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       OverscriptBox["r", "."], "2"], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       SuperscriptBox[
        OverscriptBox["\[Theta]", "."], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "."], "2"]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7439164635842733`*^9, 3.7439164992135983`*^9}, 
   3.743916771037909*^9, {3.7439168165545797`*^9, 3.743916859984042*^9}, {
   3.743916927305007*^9, 3.743916949569796*^9}, {3.74391717796529*^9, 
   3.7439172144975357`*^9}, {3.743917352443534*^9, 3.7439173988802357`*^9}},
 CellLabel->
  "In[709]:=",ExpressionUUID->"a83ee66e-9197-44b3-99a4-b0962f152dc6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"V", "=", 
  RowBox[{
   RowBox[{"-", "G"}], " ", 
   SubscriptBox["m", "s"], " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     FractionBox[
      SubscriptBox["M", "i"], 
      SubscriptBox["d", "i"]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"\[Sun]", ",", "\[Earth]", ",", "\[Mars]"}], "}"}]}], "}"}]}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.743916950847211*^9, 3.743917029336252*^9}, {
  3.743918644397482*^9, 3.74391864745894*^9}, {3.743918744376626*^9, 
  3.743918758791971*^9}, {3.743918799006173*^9, 3.7439188128003273`*^9}, {
  3.7439188915151987`*^9, 3.7439189640615788`*^9}, {3.743919968752591*^9, 
  3.743920043659421*^9}},
 CellLabel->
  "In[710]:=",ExpressionUUID->"013f59b4-bac5-4f27-86f0-463c3bcf0b09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "G"}], " ", 
  SubscriptBox["m", "s"], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     SubscriptBox["M", "\[Earth]"], 
     SubscriptBox["d", "\[Earth]"]], "+", 
    FractionBox[
     SubscriptBox["M", "\[Mars]"], 
     SubscriptBox["d", "\[Mars]"]], "+", 
    FractionBox[
     SubscriptBox["M", "\[Sun]"], 
     SubscriptBox["d", "\[Sun]"]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.743918919214945*^9, 3.74391896520022*^9, 
  3.74392005400825*^9, 3.743921494791253*^9, 3.743921554993293*^9, 
  3.743921774141204*^9, 3.7439218909014883`*^9, 3.74392197369029*^9, 
  3.7439220446052933`*^9, 3.7439221008505707`*^9, 3.743922161675989*^9, 
  3.743922280423398*^9, 3.743922628227706*^9, 3.7439227792326717`*^9, 
  3.74393230082164*^9, 3.743932643440627*^9},
 CellLabel->
  "Out[710]=",ExpressionUUID->"9414377b-9fce-43a1-8790-193d80bc65d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"L", "=", 
  RowBox[{"T", "-", "V"}]}]], "Input",
 CellChangeTimes->{{3.743917031175468*^9, 3.7439170412459583`*^9}},
 CellLabel->
  "In[711]:=",ExpressionUUID->"797736b8-092d-4faa-a83f-75cc5d9f60ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      OverscriptBox["r", "."], "2"], "+", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       OverscriptBox["\[Theta]", "."], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "."], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
   SubscriptBox["m", "s"]}], "+", 
  RowBox[{"G", " ", 
   SubscriptBox["m", "s"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SubscriptBox["M", "\[Earth]"], 
      SubscriptBox["d", "\[Earth]"]], "+", 
     FractionBox[
      SubscriptBox["M", "\[Mars]"], 
      SubscriptBox["d", "\[Mars]"]], "+", 
     FractionBox[
      SubscriptBox["M", "\[Sun]"], 
      SubscriptBox["d", "\[Sun]"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.743917045672905*^9, 3.743917219469542*^9, 
  3.743917365986122*^9, 3.7439174017227488`*^9, 3.7439176632756243`*^9, 
  3.74391829348985*^9, 3.743918488762129*^9, 3.743918553627178*^9, 
  3.743918981059216*^9, 3.743920054090672*^9, 3.743921494862616*^9, 
  3.743921555067395*^9, 3.743921774247624*^9, 3.743921891028316*^9, 
  3.743921973770377*^9, 3.7439220446978703`*^9, 3.743922100939866*^9, 
  3.743922161764641*^9, 3.743922280514048*^9, 3.743922628327663*^9, 
  3.743922779314024*^9, 3.743932300910536*^9, 3.743932643522748*^9},
 CellLabel->
  "Out[711]=",ExpressionUUID->"2db6a819-0e03-4d73-8a0b-bb23ca042193"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Step 1: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4c8b468c-6161-44d3-9735-17a1cee87b8e"]
}], "Subsection",
 CellChangeTimes->{{3.743917069705556*^9, 
  3.7439170768049726`*^9}},ExpressionUUID->"7e3c859d-a21d-4db9-8ef9-\
1581253e7763"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["p", "r"], "=", 
  RowBox[{"D", "[", 
   RowBox[{"L", ",", 
    OverscriptBox["r", "."]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7439170811455936`*^9, 3.7439170985984573`*^9}, {
  3.7439171779711103`*^9, 3.743917184000648*^9}, {3.743917338867929*^9, 
  3.743917340665864*^9}, {3.743917579097642*^9, 3.7439175808556643`*^9}, {
  3.743918180850748*^9, 3.7439181858903723`*^9}, {3.7439219478330593`*^9, 
  3.743921949198965*^9}},
 CellLabel->
  "In[712]:=",ExpressionUUID->"ce8f3667-eeb1-495b-9c27-e79b4af5c7f7"],

Cell[BoxData[
 RowBox[{
  OverscriptBox["r", "."], " ", 
  SubscriptBox["m", "s"]}]], "Output",
 CellChangeTimes->{{3.743917111634912*^9, 3.7439171310428553`*^9}, 
   3.743917224876305*^9, {3.743917341088668*^9, 3.7439173732022*^9}, 
   3.7439174049309187`*^9, 3.743917593452498*^9, {3.7439176376269913`*^9, 
   3.743917663354954*^9}, 3.743918242775487*^9, 3.7439182935813627`*^9, 
   3.743918488869866*^9, 3.743918553711027*^9, 3.7439189864605494`*^9, 
   3.743920054188943*^9, 3.7439214949471693`*^9, 3.743921555150222*^9, 
   3.743921774364378*^9, 3.7439218912271*^9, 3.743921973876339*^9, 
   3.743922044799672*^9, 3.743922101056099*^9, 3.743922161865157*^9, 
   3.743922280599491*^9, 3.743922628427062*^9, 3.7439227794819107`*^9, 
   3.743932300992406*^9, 3.7439326436198*^9},
 CellLabel->
  "Out[712]=",ExpressionUUID->"d4ba0632-16c9-4638-948c-69df18623483"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["p", "\[Theta]"], "=", 
  RowBox[{"D", "[", 
   RowBox[{"L", ",", 
    OverscriptBox["\[Theta]", "."]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7439170811455936`*^9, 3.7439170985984573`*^9}, {
  3.7439171779711103`*^9, 3.743917184000648*^9}, {3.7439172457139263`*^9, 
  3.74391724917835*^9}, {3.743917409142786*^9, 3.743917422303342*^9}, {
  3.743917582785392*^9, 3.7439175850597897`*^9}, {3.7439181899622107`*^9, 
  3.743918239090589*^9}, {3.743918278289014*^9, 3.7439182875115967`*^9}, {
  3.7439219520719643`*^9, 3.74392195928036*^9}},
 CellLabel->
  "In[713]:=",ExpressionUUID->"565426e4-4a52-4996-aac2-d3f4871de26a"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  OverscriptBox["\[Theta]", "."], " ", 
  SubscriptBox["m", "s"]}]], "Output",
 CellChangeTimes->{
  3.743917249693762*^9, 3.74391742274892*^9, 3.7439175941031847`*^9, {
   3.7439176385930357`*^9, 3.743917663440136*^9}, {3.743918234939371*^9, 
   3.7439182395141497`*^9}, 3.743918293681405*^9, 3.743918488952956*^9, 
   3.7439185538326397`*^9, 3.743918987239608*^9, 3.743920054288145*^9, 
   3.743921495028831*^9, 3.7439215552348967`*^9, 3.7439217744810877`*^9, 
   3.743921891330002*^9, 3.7439219739913177`*^9, 3.743922044914681*^9, 
   3.7439221011567907`*^9, 3.743922161982211*^9, 3.743922280698134*^9, 
   3.743922628527341*^9, 3.743922779580748*^9, 3.743932301075303*^9, 
   3.743932643735927*^9},
 CellLabel->
  "Out[713]=",ExpressionUUID->"c956dfd6-c199-4abd-879d-822f85b48c23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["p", "\[Phi]"], "=", 
  RowBox[{"D", "[", 
   RowBox[{"L", ",", 
    OverscriptBox["\[Phi]", "."]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7439170811455936`*^9, 3.7439170985984573`*^9}, {
  3.7439171779711103`*^9, 3.743917184000648*^9}, {3.74391724045779*^9, 
  3.7439172439767113`*^9}, {3.743917425048109*^9, 3.743917429566996*^9}, {
  3.743917586624997*^9, 3.7439175891133842`*^9}, {3.74391828196097*^9, 
  3.743918283111923*^9}, {3.743921954448324*^9, 3.743921956117425*^9}},
 CellLabel->
  "In[714]:=",ExpressionUUID->"5a8f7e11-5745-4c26-9aeb-2d7f02dc7d7b"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  OverscriptBox["\[Phi]", "."], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
  SubscriptBox["m", "s"]}]], "Output",
 CellChangeTimes->{
  3.743917250425004*^9, 3.7439174302324533`*^9, 3.7439175946801367`*^9, {
   3.743917639136746*^9, 3.743917663523301*^9}, 3.7439182937963467`*^9, 
   3.743918489037354*^9, 3.7439185539149218`*^9, 3.7439189880032043`*^9, 
   3.743920054389845*^9, 3.743921495113553*^9, 3.7439215553187447`*^9, 
   3.7439217745963182`*^9, 3.743921891444869*^9, 3.743921974107209*^9, 
   3.743922045015708*^9, 3.743922101255394*^9, 3.743922162081957*^9, 
   3.743922280781485*^9, 3.743922628627524*^9, 3.7439227796807203`*^9, 
   3.743932301159604*^9, 3.7439326438346767`*^9},
 CellLabel->
  "Out[714]=",ExpressionUUID->"5c10a0c0-b5a1-4a22-87b5-7ab70cc3aab3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Step 2: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["q", "."], "i"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["q", "."], "i"], "(", 
     RowBox[{
      OverscriptBox["q", "_"], ",", 
      OverscriptBox["p", "_"], ",", "t"}], ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7acc8c8c-140d-460a-b1c5-9deae5761626"]
}], "Subsection",
 CellChangeTimes->{{3.743917276090006*^9, 3.743917317622138*^9}, {
  3.7439174548618107`*^9, 
  3.743917501109508*^9}},ExpressionUUID->"e88dc845-f86d-42ac-8b11-\
4c8c6f9e2b57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rDotRule", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"pr", "\[Equal]", 
      SubscriptBox["p", "r"]}], ",", 
     OverscriptBox["r", "."]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7439175093671007`*^9, 3.74391754946428*^9}, {
  3.743917628144578*^9, 3.743917675407518*^9}, {3.7439181198531313`*^9, 
  3.7439181199222593`*^9}, {3.7439190429701557`*^9, 3.743919091381291*^9}},
 CellLabel->
  "In[715]:=",ExpressionUUID->"2977a948-9a8a-469f-97e2-2da01f34e60d"],

Cell[BoxData[
 RowBox[{
  OverscriptBox["r", "."], "\[Rule]", 
  FractionBox["pr", 
   SubscriptBox["m", "s"]]}]], "Output",
 CellChangeTimes->{{3.743917520447929*^9, 3.7439175501424932`*^9}, {
   3.7439176339659233`*^9, 3.743917675697733*^9}, 3.7439181206058483`*^9, 
   3.743918293979154*^9, 3.743918331234971*^9, 3.7439184892236*^9, 
   3.743918554081697*^9, {3.743919035917087*^9, 3.7439190725478992`*^9}, 
   3.743919104063575*^9, 3.7439200544897823`*^9, 3.7439214951797028`*^9, 
   3.7439215554003077`*^9, 3.743921774698042*^9, 3.743921891562625*^9, 
   3.743921974220039*^9, 3.743922045115514*^9, 3.743922101440289*^9, 
   3.743922162181439*^9, 3.743922280864626*^9, 3.743922628728004*^9, 
   3.743922779780744*^9, 3.743932301237859*^9, 3.743932643935108*^9},
 CellLabel->
  "Out[715]=",ExpressionUUID->"160a4186-b304-4769-b2a7-17f1b28411f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Theta]DotRule", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"p\[Theta]", "\[Equal]", 
      SubscriptBox["p", "\[Theta]"]}], ",", 
     OverscriptBox["\[Theta]", "."]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.743918124948607*^9, {3.7439183105199223`*^9, 3.7439183263500233`*^9}, {
   3.7439190800071363`*^9, 3.7439190986767473`*^9}},
 CellLabel->
  "In[716]:=",ExpressionUUID->"e9d9dae2-276f-41c8-9b3f-de582275719f"],

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[Theta]", "."], "\[Rule]", 
  FractionBox["p\[Theta]", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SubscriptBox["m", "s"]}]]}]], "Output",
 CellChangeTimes->{{3.743918303011771*^9, 3.743918332070808*^9}, 
   3.743918489307653*^9, 3.74391855416488*^9, 3.74391903761455*^9, {
   3.7439190824040833`*^9, 3.743919107485676*^9}, 3.7439200545899897`*^9, 
   3.743921495259013*^9, 3.743921555485504*^9, 3.743921774796541*^9, 
   3.743921891679965*^9, 3.743921974303643*^9, 3.7439220452183867`*^9, 
   3.743922101622946*^9, 3.743922162279394*^9, 3.743922280952655*^9, 
   3.743922628828018*^9, 3.743922779879773*^9, 3.743932301476734*^9, 
   3.743932644035009*^9},
 CellLabel->
  "Out[716]=",ExpressionUUID->"cf9207aa-c9ee-4fd1-81b1-85021fa4f509"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Phi]DotRule", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"p\[Phi]", "\[Equal]", 
      SubscriptBox["p", "\[Phi]"]}], ",", 
     OverscriptBox["\[Phi]", "."]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.743918316580553*^9, 3.743918328557156*^9}, {
  3.7439190843990707`*^9, 3.743919101988953*^9}},
 CellLabel->
  "In[717]:=",ExpressionUUID->"5d492020-480d-440a-8765-ba6fe2804286"],

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[Phi]", "."], "\[Rule]", 
  FractionBox["p\[Phi]", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
    SubscriptBox["m", "s"]}]]}]], "Output",
 CellChangeTimes->{
  3.7439183333442173`*^9, 3.743918489390245*^9, 3.743918554247303*^9, 
   3.743919038617988*^9, {3.743919086034346*^9, 3.743919108657731*^9}, 
   3.743920054690508*^9, 3.743921495346937*^9, 3.743921555569116*^9, 
   3.74392177488971*^9, 3.743921891796976*^9, 3.743921974385434*^9, 
   3.743922045319449*^9, 3.7439221018081293`*^9, 3.7439221624439907`*^9, 
   3.743922281048635*^9, 3.7439226289282513`*^9, 3.743922779962399*^9, 
   3.743932301807131*^9, 3.743932644133813*^9},
 CellLabel->
  "Out[717]=",ExpressionUUID->"c335ce43-3592-4064-a729-1f5d11eca9b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "=", 
  RowBox[{
   RowBox[{"T", "/.", 
    RowBox[{"{", 
     RowBox[{"rDotRule", ",", "\[Theta]DotRule", ",", "\[Phi]DotRule"}], 
     "}"}]}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.7439191167168207`*^9, 3.743919182977956*^9}},
 CellLabel->
  "In[718]:=",ExpressionUUID->"4cb8c8d2-3130-4411-8987-cbde8566485a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["pr", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Theta]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Phi]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
    SubscriptBox["m", "s"]}]]}]], "Output",
 CellChangeTimes->{{3.743919117136004*^9, 3.7439191858227367`*^9}, 
   3.743920054789075*^9, 3.743921495525817*^9, 3.7439215556520233`*^9, 
   3.743921774998314*^9, 3.743921891980053*^9, 3.74392197447505*^9, 
   3.743922045419427*^9, 3.7439221019982452`*^9, 3.743922162698615*^9, 
   3.743922281130538*^9, 3.7439226290275383`*^9, 3.743922780064699*^9, 
   3.743932302956744*^9, 3.7439326442349586`*^9},
 CellLabel->
  "Out[718]=",ExpressionUUID->"8be514e4-6088-4e90-818f-fabdf50f002d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"L", "=", 
  RowBox[{"T", "-", "V"}]}]], "Input",
 CellChangeTimes->{{3.743919191498189*^9, 3.7439192147929773`*^9}},
 CellLabel->
  "In[719]:=",ExpressionUUID->"3fc63d3d-fd32-4ebc-8886-3e0de9bb7f7e"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["pr", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Theta]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Phi]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
    SubscriptBox["m", "s"]}]], "+", 
  RowBox[{"G", " ", 
   SubscriptBox["m", "s"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SubscriptBox["M", "\[Earth]"], 
      SubscriptBox["d", "\[Earth]"]], "+", 
     FractionBox[
      SubscriptBox["M", "\[Mars]"], 
      SubscriptBox["d", "\[Mars]"]], "+", 
     FractionBox[
      SubscriptBox["M", "\[Sun]"], 
      SubscriptBox["d", "\[Sun]"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.743919192316572*^9, 3.743919215109119*^9}, 
   3.74392005488947*^9, 3.7439214956940527`*^9, 3.7439215557344027`*^9, 
   3.743921775096685*^9, 3.743921892096037*^9, 3.743921974554454*^9, 
   3.7439220455188093`*^9, 3.743922102089609*^9, 3.743922162846258*^9, 
   3.743922281214533*^9, 3.74392262912752*^9, 3.743922780163993*^9, 
   3.743932303557692*^9, 3.743932644335116*^9},
 CellLabel->
  "Out[719]=",ExpressionUUID->"ec6dab6d-66b2-48c6-a620-1d516c076e1b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 3: H", "Subsection",
 CellChangeTimes->{{3.743919224953533*^9, 
  3.743919227406661*^9}},ExpressionUUID->"8c42dc22-09e2-4ae1-91d0-\
536c6bee8a27"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{"pr", "*", 
    RowBox[{"(", 
     RowBox[{
      OverscriptBox["r", "."], "/.", "rDotRule"}], ")"}]}], "+", 
   RowBox[{"p\[Theta]", "*", 
    RowBox[{"(", 
     RowBox[{
      OverscriptBox["\[Theta]", "."], "/.", "\[Theta]DotRule"}], ")"}]}], "+", 
   RowBox[{"p\[Phi]", "*", 
    RowBox[{"(", 
     RowBox[{
      OverscriptBox["\[Phi]", "."], "/.", "\[Phi]DotRule"}], ")"}]}], "-", 
   "L"}]}]], "Input",
 CellChangeTimes->{{3.743919231113196*^9, 3.743919243223781*^9}, {
  3.743919441791686*^9, 3.743919517029641*^9}, {3.743919590430047*^9, 
  3.743919675809794*^9}, {3.7439220288628597`*^9, 3.743922043612432*^9}},
 CellLabel->
  "In[720]:=",ExpressionUUID->"43f39f59-b789-42b3-80fe-e184f9363fd0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["pr", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Theta]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Phi]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
    SubscriptBox["m", "s"]}]], "-", 
  RowBox[{"G", " ", 
   SubscriptBox["m", "s"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SubscriptBox["M", "\[Earth]"], 
      SubscriptBox["d", "\[Earth]"]], "+", 
     FractionBox[
      SubscriptBox["M", "\[Mars]"], 
      SubscriptBox["d", "\[Mars]"]], "+", 
     FractionBox[
      SubscriptBox["M", "\[Sun]"], 
      SubscriptBox["d", "\[Sun]"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.743919457917244*^9, 3.74391951766261*^9}, {
   3.743919602302845*^9, 3.743919676480731*^9}, 3.743920054993505*^9, 
   3.7439214962136803`*^9, 3.7439215558180513`*^9, 3.743921775232996*^9, 
   3.743921892213109*^9, 3.743921974637865*^9, 3.743922045703719*^9, 
   3.7439221021903133`*^9, 3.7439221629350443`*^9, 3.743922281298541*^9, 
   3.743922629293212*^9, 3.743922780263893*^9, 3.7439323038395*^9, 
   3.74393264443502*^9},
 CellLabel->
  "Out[720]=",ExpressionUUID->"7879e93f-e409-4235-8852-bebddcc6e9d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Derivations of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d", "i"], "=", 
    RowBox[{"|", 
     RowBox[{"r", "-", 
      SubscriptBox["r", "i"]}], "|"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ba0bcfc1-50e0-47c6-ac48-4e59b30e7448"]
}], "Subsubsection",
 CellChangeTimes->{{3.743919891990484*^9, 3.7439199041464863`*^9}, {
  3.743920071940671*^9, 
  3.7439200724098454`*^9}},ExpressionUUID->"6f039053-61c6-4389-b213-\
be2b34b462fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"r", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"r", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "[", 
   RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"r", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7439152649174633`*^9, 3.74391531506021*^9}, {
  3.743915397462069*^9, 3.743915414648882*^9}, {3.7439201045728683`*^9, 
  3.74392010892343*^9}},
 CellLabel->
  "In[721]:=",ExpressionUUID->"3f0034b7-7bbf-4f49-9847-0175fa391886"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"di", "=", 
  RowBox[{
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
         RowBox[{"x", "[", 
          RowBox[{"ri", ",", "\[Theta]i", ",", "\[Phi]i"}], "]"}]}], ")"}], 
       "^", "2"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "-", 
         RowBox[{"y", "[", 
          RowBox[{"ri", ",", "\[Theta]i", ",", "\[Phi]i"}], "]"}]}], ")"}], 
       "^", "2"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"ri", ",", "\[Theta]i"}], "]"}]}], ")"}], "^", "2"}]}], 
     "\[IndentingNewLine]", ")"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.743915538985599*^9, 3.743915643443342*^9}, {
  3.743915676271706*^9, 3.7439157067044897`*^9}, {3.743915744510264*^9, 
  3.743915778172386*^9}, {3.7439158085274878`*^9, 3.7439159501260033`*^9}, {
  3.743920083366894*^9, 3.743920084117359*^9}, {3.743920196730239*^9, 
  3.743920217405971*^9}, {3.7439203605877523`*^9, 3.743920361010591*^9}},
 CellLabel->
  "In[724]:=",ExpressionUUID->"d0fe34e6-51bc-43a1-8a38-615b1f40c272"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox["r", "2"], "+", 
   SuperscriptBox["ri", "2"], "-", 
   RowBox[{"2", " ", "r", " ", "ri", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]i"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.7439200921890173`*^9, 3.74392010129683*^9}, {
   3.743920349421566*^9, 3.743920361520363*^9}, 3.7439205436011963`*^9, 
   3.743921497186722*^9, 3.743921556426201*^9, 3.743921775907799*^9, 
   3.743921892868957*^9, 3.743921975456504*^9, 3.7439220466584053`*^9, 
   3.74392210288597*^9, 3.7439221636613207`*^9, 3.7439222823896523`*^9, 
   3.743922630044784*^9, 3.743922781030424*^9, 3.7439323046179733`*^9, 
   3.743932645383052*^9},
 CellLabel->
  "Out[724]=",ExpressionUUID->"6aba4dfe-7528-43c4-91ed-e854883ce376"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sunRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "i"], "\[Rule]", 
      SubscriptBox["M", "\[Sun]"]}], ",", 
     RowBox[{"ri", "\[Rule]", "r\[Sun]"}], ",", 
     RowBox[{"\[Theta]i", "\[Rule]", "\[Theta]\[Sun]"}], ",", 
     RowBox[{"\[Phi]i", "\[Rule]", "\[Phi]\[Sun]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"earthRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "i"], "\[Rule]", 
      SubscriptBox["M", "\[Earth]"]}], ",", 
     RowBox[{"ri", "\[Rule]", "r\[Earth]"}], ",", 
     RowBox[{"\[Theta]i", "\[Rule]", "\[Theta]\[Earth]"}], ",", 
     RowBox[{"\[Phi]i", "\[Rule]", "\[Phi]\[Earth]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"marsRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "i"], "\[Rule]", 
      SubscriptBox["M", "\[Mars]"]}], ",", 
     RowBox[{"ri", "\[Rule]", "r\[Mars]"}], ",", 
     RowBox[{"\[Theta]i", "\[Rule]", "\[Theta]\[Mars]"}], ",", 
     RowBox[{"\[Phi]i", "\[Rule]", "\[Phi]\[Mars]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7439286401176157`*^9, 3.743928693155108*^9}, {
  3.743928799881342*^9, 3.743928839236117*^9}, {3.743928893557725*^9, 
  3.743928901226891*^9}},
 CellLabel->
  "In[725]:=",ExpressionUUID->"78e9a5fb-2ccf-4cec-98f3-e1acf11b8cd3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sunDistance", "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["d", "\[Sun]"], "\[Rule]", "di"}], "/.", 
   "sunRules"}]}]], "Input",
 CellChangeTimes->{{3.7439209914409933`*^9, 3.743921010994606*^9}, 
   3.7439210430865593`*^9, {3.74392114185565*^9, 3.7439211921035013`*^9}, {
   3.743921295582316*^9, 3.7439213024300423`*^9}, {3.7439213659311028`*^9, 
   3.743921389226429*^9}, {3.743921841485661*^9, 3.743921849538354*^9}, {
   3.743928646095887*^9, 3.743928661027012*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"07713999-d911-4711-a649-dd5802499922"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d", "\[Sun]"], "\[Rule]", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["r\[Sun]", "2"], "-", 
    RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.7439209918498497`*^9, 3.743921012838461*^9}, 
   3.743921142739119*^9, 3.743921192997903*^9, 3.7439212980021467`*^9, {
   3.74392136329543*^9, 3.743921375551056*^9}, 3.743921413988935*^9, 
   3.7439214974625597`*^9, 3.743921556569788*^9, 3.74392177599652*^9, {
   3.743921888137884*^9, 3.743921893064067*^9}, 3.743921975557993*^9, 
   3.74392204685148*^9, 3.7439221030405893`*^9, 3.74392216374886*^9, 
   3.743922282517436*^9, 3.743922630145214*^9, 3.743922781149178*^9, 
   3.743928721160087*^9, 3.743928842889152*^9, 3.743932304757118*^9, 
   3.7439326455539103`*^9},
 CellLabel->
  "Out[728]=",ExpressionUUID->"e7aa0906-7071-4f2b-bebf-cee409733ebb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"earthDistance", "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["d", "\[Earth]"], "\[Rule]", "di"}], "/.", 
   "earthRules"}]}]], "Input",
 CellChangeTimes->{{3.7439209914409933`*^9, 3.743921010994606*^9}, 
   3.7439210430865593`*^9, {3.74392114185565*^9, 3.743921217118534*^9}, {
   3.743921318540841*^9, 3.743921322865238*^9}, {3.743921370219289*^9, 
   3.743921394880583*^9}, {3.743921866059126*^9, 3.743921872985818*^9}, {
   3.7439286644947367`*^9, 3.743928680227298*^9}, {3.7439287123466454`*^9, 
   3.7439287168531322`*^9}},
 CellLabel->
  "In[729]:=",ExpressionUUID->"69e4f982-312e-4d3e-b60f-54d460b9fffd"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d", "\[Earth]"], "\[Rule]", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["r\[Earth]", "2"], "-", 
    RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.743921284754737*^9, 3.7439213283574467`*^9, {3.743921363379242*^9, 
   3.743921375622501*^9}, 3.743921414163377*^9, 3.743921497637274*^9, 
   3.743921556652276*^9, 3.7439217760979023`*^9, {3.743921889462397*^9, 
   3.743921893166644*^9}, 3.743921975657571*^9, 3.7439220469515333`*^9, 
   3.743922103140358*^9, 3.743922163913196*^9, 3.743922282598095*^9, 
   3.743922630311564*^9, 3.743922781245854*^9, 3.7439287223491087`*^9, 
   3.7439323048475637`*^9, 3.74393264565201*^9},
 CellLabel->
  "Out[729]=",ExpressionUUID->"df9ee551-49f6-42d7-94c8-da745807a875"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"marsDistance", "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["d", "\[Mars]"], "\[Rule]", "di"}], "/.", 
   "marsRules"}]}]], "Input",
 CellChangeTimes->{{3.743920931738703*^9, 3.743920933215775*^9}, {
  3.743921325574511*^9, 3.743921353233119*^9}, {3.74392139673873*^9, 
  3.743921397376313*^9}, {3.743921880258375*^9, 3.743921886169104*^9}, {
  3.743928677926688*^9, 3.743928678841907*^9}, {3.7439287181161947`*^9, 
  3.7439287198236628`*^9}},
 CellLabel->
  "In[730]:=",ExpressionUUID->"eb4d7356-c626-488d-8374-c58fa1b907ce"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["d", "\[Mars]"], "\[Rule]", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["r\[Mars]", "2"], "-", 
    RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.74392093357791*^9, {3.743921356714682*^9, 3.743921375694965*^9}, 
   3.7439214142670307`*^9, 3.743921497831871*^9, 3.74392155673589*^9, 
   3.7439217761972446`*^9, 3.743921893282504*^9, 3.7439219757766037`*^9, 
   3.743922047038014*^9, 3.74392210324026*^9, 3.743922164029808*^9, 
   3.7439222826832848`*^9, 3.743922630411508*^9, 3.743922781346221*^9, 
   3.743928724242838*^9, 3.743932304956914*^9, 3.743932645751029*^9},
 CellLabel->
  "Out[730]=",ExpressionUUID->"fc833f80-c817-4073-b9b8-0a4ddfaeb41e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final H", "Subsubsection",
 CellChangeTimes->{{3.74392147051941*^9, 
  3.743921472013754*^9}},ExpressionUUID->"922cd5dd-cf66-4890-b367-\
e88ca7bd7615"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{"H", "/.", 
   RowBox[{"{", 
    RowBox[{"sunDistance", ",", "earthDistance", ",", "marsDistance"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.743921379953673*^9, 3.7439214047275877`*^9}, {
  3.743921508222785*^9, 3.743921508389081*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"d0a9caa6-d1e8-41d4-81b9-72896d0491f7"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["pr", "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Theta]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SubscriptBox["m", "s"]}]], "+", 
  FractionBox[
   SuperscriptBox["p\[Phi]", "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
    SubscriptBox["m", "s"]}]], "-", 
  RowBox[{"G", " ", 
   SubscriptBox["m", "s"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SubscriptBox["M", "\[Earth]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["r\[Earth]", "2"], "-", 
        RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}]]], 
     "+", 
     FractionBox[
      SubscriptBox["M", "\[Mars]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["r\[Mars]", "2"], "-", 
        RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}]]], 
     "+", 
     FractionBox[
      SubscriptBox["M", "\[Sun]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["r\[Sun]", "2"], "-", 
        RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}]]]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.743921385839085*^9, 3.743921414365964*^9}, {
   3.743921501018753*^9, 3.743921509050267*^9}, 3.743921559554517*^9, 
   3.7439217792693663`*^9, 3.743921896598461*^9, 3.743921979110322*^9, 
   3.743922050047616*^9, 3.743922106319915*^9, 3.743922166984597*^9, 
   3.743922285485018*^9, 3.7439226334809093`*^9, 3.74392278450115*^9, 
   3.743932305073249*^9, 3.7439326458528833`*^9},
 CellLabel->
  "Out[731]=",ExpressionUUID->"b5ec0578-a233-4b0d-9330-104dcb1f8a2c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 4.1: Hamilton\[CloseCurlyQuote]s equations (directly)", \
"Subsection",
 CellChangeTimes->{{3.743919706721579*^9, 3.743919735478032*^9}, {
  3.7439215103761578`*^9, 3.7439215110992613`*^9}, {3.743928038261569*^9, 
  3.743928041541477*^9}, {3.7439282850852833`*^9, 
  3.7439282851635523`*^9}},ExpressionUUID->"52e09240-1e4a-4258-9fac-\
becd1c694c18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rdot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"D", "[", 
    RowBox[{"H", ",", "pr"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.743919836177669*^9, 3.743919849642722*^9}, {
   3.743921533750246*^9, 3.7439215505414143`*^9}, {3.743921639207863*^9, 
   3.743921650760944*^9}, {3.743921681607641*^9, 3.743921681878438*^9}, {
   3.7439220717325993`*^9, 3.743922072275103*^9}, {3.743922268481142*^9, 
   3.743922269890656*^9}, 3.743922616084124*^9, 3.743922765820801*^9},
 CellLabel->
  "In[732]:=",ExpressionUUID->"b61f0438-0d53-465d-83e3-9b04ab881a4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["r", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  FractionBox["pr", 
   SubscriptBox["m", "s"]]}]], "Output",
 CellChangeTimes->{
  3.743919860344482*^9, 3.7439207670337677`*^9, 3.743920859435976*^9, {
   3.743921501212076*^9, 3.743921559622773*^9}, 3.743921612465439*^9, 
   3.7439216513740263`*^9, {3.743921771583786*^9, 3.7439217793489523`*^9}, 
   3.743921896732839*^9, 3.7439219792093554`*^9, 3.743922050132251*^9, 
   3.7439221064233503`*^9, 3.743922167079932*^9, 3.743922285564768*^9, 
   3.743922633579895*^9, 3.743922784598372*^9, 3.743932305271594*^9, 
   3.7439326459520283`*^9},
 CellLabel->
  "Out[732]=",ExpressionUUID->"7a79437f-18d1-4385-9d5f-908c6efbef1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Theta]dot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"D", "[", 
    RowBox[{"H", ",", "p\[Theta]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.743919836177669*^9, 3.743919849642722*^9}, {
   3.743920775693075*^9, 3.743920776806076*^9}, {3.7439216203620462`*^9, 
   3.743921679502204*^9}, {3.743922074614366*^9, 3.743922076011145*^9}, 
   3.7439222733855143`*^9, 3.74392261786063*^9, 3.743922767589632*^9},
 CellLabel->
  "In[733]:=",ExpressionUUID->"78608010-2522-4733-809c-f5a854c80883"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Theta]", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  FractionBox["p\[Theta]", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SubscriptBox["m", "s"]}]]}]], "Output",
 CellChangeTimes->{
  3.743920777421761*^9, 3.7439208579302597`*^9, 3.7439215013756523`*^9, 
   3.743921559706293*^9, 3.7439216249198513`*^9, {3.743921771656954*^9, 
   3.743921779432629*^9}, 3.743921896815546*^9, 3.743921979290122*^9, 
   3.743922050283597*^9, 3.743922106522477*^9, 3.743922167185062*^9, 
   3.743922285649556*^9, 3.7439226336966467`*^9, 3.743922784701108*^9, 
   3.74393230545809*^9, 3.7439326460526333`*^9},
 CellLabel->
  "Out[733]=",ExpressionUUID->"b5fe9365-f25b-43cd-b6f5-faa0b5df53eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Phi]dot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"D", "[", 
    RowBox[{"H", ",", "p\[Phi]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.743920782461486*^9, 3.743920808959942*^9}, {
   3.743921662546424*^9, 3.743921675631464*^9}, {3.7439220785780478`*^9, 
   3.743922080707062*^9}, 3.7439222745614147`*^9, 3.743922619564258*^9, 
   3.743922769037471*^9},
 CellLabel->
  "In[734]:=",ExpressionUUID->"4d86703d-3891-4f15-9245-c09423af1c6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Phi]", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  FractionBox["p\[Phi]", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
    SubscriptBox["m", "s"]}]]}]], "Output",
 CellChangeTimes->{
  3.743920809774413*^9, 3.743920856212521*^9, 3.7439215016112127`*^9, 
   3.743921559789287*^9, {3.7439217717333603`*^9, 3.743921779516242*^9}, 
   3.743921896895755*^9, 3.7439219794255323`*^9, 3.743922050549419*^9, 
   3.743922106623708*^9, 3.743922167285625*^9, 3.74392228583797*^9, 
   3.7439226338128138`*^9, 3.7439227848155413`*^9, 3.7439323056416893`*^9, 
   3.743932646151949*^9},
 CellLabel->
  "Out[734]=",ExpressionUUID->"55bcd88d-1a4b-46e0-87f4-db128bf1b793"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prdot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"pr", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"H", ",", "r"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.743921723701434*^9, 3.743921750717201*^9}, {
   3.74392212442739*^9, 3.743922131335479*^9}, 3.7439222759214573`*^9, 
   3.7439226210846148`*^9, 3.7439227596699142`*^9, 3.743927581302148*^9},
 CellLabel->
  "In[735]:=",ExpressionUUID->"8e90969f-6ccc-4176-b09c-2655e3eb0436"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["pr", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["p\[Theta]", "2"], 
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     SubscriptBox["m", "s"]}]], "+", 
   FractionBox[
    SuperscriptBox["p\[Phi]", "2"], 
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     SubscriptBox["m", "s"]}]], "+", 
   RowBox[{"G", " ", 
    SubscriptBox["m", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "r"}], "-", 
           RowBox[{"2", " ", "r\[Earth]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}], 
          ")"}], " ", 
         SubscriptBox["M", "\[Earth]"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            SuperscriptBox["r\[Earth]", "2"], "-", 
            RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}], 
           ")"}], 
          RowBox[{"3", "/", "2"}]]}]]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "r"}], "-", 
          RowBox[{"2", " ", "r\[Mars]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}], 
         ")"}], " ", 
        SubscriptBox["M", "\[Mars]"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           SuperscriptBox["r\[Mars]", "2"], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}], 
          ")"}], 
         RowBox[{"3", "/", "2"}]]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "r"}], "-", 
          RowBox[{"2", " ", "r\[Sun]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}], 
         ")"}], " ", 
        SubscriptBox["M", "\[Sun]"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           SuperscriptBox["r\[Sun]", "2"], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}], 
          ")"}], 
         RowBox[{"3", "/", "2"}]]}]]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.7439217718147*^9, 3.743921779596285*^9}, 
   3.743921896974593*^9, 3.743921979577467*^9, 3.7439220507029953`*^9, 
   3.743922106725747*^9, 3.743922167382374*^9, 3.74392259296238*^9, {
   3.743922778278083*^9, 3.7439227849287167`*^9}, 3.743927581814146*^9, 
   3.743928438184115*^9, 3.743930988997871*^9, 3.743932305806726*^9, 
   3.743932646250455*^9},
 CellLabel->
  "Out[735]=",ExpressionUUID->"6b44be71-28df-4994-9f56-6b811989f363"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p\[Theta]dot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"p\[Theta]", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"H", ",", "\[Theta]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7439217553033648`*^9, 3.743921765293111*^9}, {
   3.74392213615559*^9, 3.743922141408424*^9}, 3.743922277012183*^9, 
   3.743922623026476*^9, 3.743922761340938*^9, 3.743927584372233*^9},
 CellLabel->
  "In[736]:=",ExpressionUUID->"10746d68-cea8-4577-8496-eaf6e9c5f3de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["p\[Theta]", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["p\[Phi]", "2"], 
    RowBox[{
     SuperscriptBox["r", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
     SubscriptBox["m", "s"]}]], "+", 
   RowBox[{"G", " ", 
    SubscriptBox["m", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"r", " ", "r\[Earth]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], " ", 
        SubscriptBox["M", "\[Earth]"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["r\[Earth]", "2"], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}], 
         ")"}], 
        RowBox[{"3", "/", "2"}]]], "+", 
      FractionBox[
       RowBox[{"r", " ", "r\[Mars]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], " ", 
        SubscriptBox["M", "\[Mars]"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["r\[Mars]", "2"], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}], 
         ")"}], 
        RowBox[{"3", "/", "2"}]]], "+", 
      FractionBox[
       RowBox[{"r", " ", "r\[Sun]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], " ", 
        SubscriptBox["M", "\[Sun]"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["r\[Sun]", "2"], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}], 
         ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.7439217719523573`*^9, 3.743921779698968*^9}, 
   3.7439218970637903`*^9, 3.743921979780376*^9, 3.743922050800003*^9, 
   3.743922106824853*^9, 3.743922167501503*^9, 3.7439227850499067`*^9, 
   3.743927584662486*^9, 3.743928440223509*^9, 3.743930990409459*^9, 
   3.7439323059066277`*^9, 3.743932646351609*^9},
 CellLabel->
  "Out[736]=",ExpressionUUID->"62cac8bd-c7d6-4b81-9bf7-bf4cb67851a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p\[Phi]dot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"p\[Phi]", "'"}], "[", "t", "]"}], "\[Equal]", 
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"H", ",", "\[Phi]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7439217620745373`*^9, 3.743921767763166*^9}, {
   3.74392215118635*^9, 3.743922156638842*^9}, 3.743922279361384*^9, 
   3.743922625408424*^9, 3.743922771876541*^9, 3.743927587350274*^9},
 CellLabel->
  "In[737]:=",ExpressionUUID->"01fc6d9f-85e4-465b-a57e-a432b018e915"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["p\[Phi]", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  RowBox[{"G", " ", 
   SubscriptBox["m", "s"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"r", " ", "r\[Earth]", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
        SubscriptBox["M", "\[Earth]"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["r\[Earth]", "2"], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}], 
         ")"}], 
        RowBox[{"3", "/", "2"}]]]}], "-", 
     FractionBox[
      RowBox[{"r", " ", "r\[Mars]", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
       SubscriptBox["M", "\[Mars]"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         SuperscriptBox["r\[Mars]", "2"], "-", 
         RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"3", "/", "2"}]]], "-", 
     FractionBox[
      RowBox[{"r", " ", "r\[Sun]", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
       SubscriptBox["M", "\[Sun]"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         SuperscriptBox["r\[Sun]", "2"], "-", 
         RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"3", "/", "2"}]]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.743921772086795*^9, 3.743921779798951*^9}, 
   3.74392189716325*^9, 3.743921979958468*^9, 3.743922050903454*^9, 
   3.743922106988978*^9, 3.7439221676159887`*^9, 3.74392278514775*^9, 
   3.7439275876623707`*^9, 3.7439309923759747`*^9, 3.743932306010021*^9, 
   3.74393264645147*^9},
 CellLabel->
  "Out[737]=",ExpressionUUID->"a72edb1e-31c4-4818-84f1-ef0947e9fef1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Extra: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    SubscriptBox["p", "r"], "."], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "8de3d5cb-8465-4b0e-8ae2-8790c6e05e72"],
 " simplified"
}], "Subsubsection",
 CellChangeTimes->{
  3.743933318522727*^9},ExpressionUUID->"60675af6-ec50-4219-b5b9-\
c433e83b3f44"],

Cell[TextData[{
 StyleBox["SMALL SIMPLIFICATION PROBLEM:\n",
  FontWeight->"Bold"],
 "The equations for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["p", "."], "r"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6d05cf3c-4626-4a3e-b308-343c81bae29e"],
 " above can\[CloseCurlyQuote]t be simplified using //Simpify, since this \
takes forever, even though it\[CloseCurlyQuote]s obviously easy to cancel \
some factor of 2. "
}], "Text",
 CellChangeTimes->{{3.743928385204646*^9, 3.743928425811384*^9}, {
  3.743932596014717*^9, 
  3.7439326110902853`*^9}},ExpressionUUID->"dbb7aa85-1cd0-4e13-96f2-\
a98476e159ae"],

Cell["\<\
We can do so manually, and copy-paste the function back together:\
\>", "Text",
 CellChangeTimes->{{3.743931652795966*^9, 3.743931676968602*^9}, 
   3.743932631429103*^9},ExpressionUUID->"1b73bfa4-f06a-40b8-9a90-\
03eb103612f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cancel", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "r"}], "-", 
        RowBox[{"2", " ", "r\[Earth]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}], 
       ")"}], " ", 
      SubscriptBox["M", "\[Earth]"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         SuperscriptBox["r\[Earth]", "2"], "-", 
         RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "r"}], "-", 
       RowBox[{"2", " ", "r\[Mars]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}], ")"}],
      " ", 
     SubscriptBox["M", "\[Mars]"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["r\[Mars]", "2"], "-", 
        RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}]}]}], 
       ")"}], 
      RowBox[{"3", "/", "2"}]]}]], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "r"}], "-", 
       RowBox[{"2", " ", "r\[Sun]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}], ")"}], 
     " ", 
     SubscriptBox["M", "\[Sun]"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        SuperscriptBox["r\[Sun]", "2"], "-", 
        RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.74393146326921*^9, 3.743931464757257*^9}},
 CellLabel->
  "In[738]:=",ExpressionUUID->"2ef9b303-1fe7-457b-8037-cccd2c7804ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"r\[Earth]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "-", 
       RowBox[{"r\[Earth]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], " ", 
     SubscriptBox["M", "\[Earth]"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["r\[Earth]", "2"], "-", 
       RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "-", 
       RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"r\[Mars]", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "-", 
      RowBox[{"r\[Mars]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], " ", 
    SubscriptBox["M", "\[Mars]"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      SuperscriptBox["r\[Mars]", "2"], "-", 
      RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "-", 
      RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"r\[Sun]", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "-", 
      RowBox[{"r\[Sun]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], " ", 
    SubscriptBox["M", "\[Sun]"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      SuperscriptBox["r\[Sun]", "2"], "-", 
      RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "-", 
      RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{3.7439314652084713`*^9, 3.74393230610833*^9, 
  3.743932646552627*^9},
 CellLabel->
  "Out[738]=",ExpressionUUID->"c07f3122-0ae2-4ee9-b3ef-e1d19a664660"]
}, Open  ]],

Cell["So a little more simplified we have:", "Text",
 CellChangeTimes->{{3.745331070533177*^9, 
  3.745331076520562*^9}},ExpressionUUID->"aa4f586b-264c-4e26-83e5-\
1ff9db22d32c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prdot2", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["pr", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
   RowBox[{
    FractionBox[
     SuperscriptBox["p\[Theta]", "2"], 
     RowBox[{
      SuperscriptBox["r", "3"], " ", 
      SubscriptBox["m", "s"]}]], "+", 
    FractionBox[
     SuperscriptBox["p\[Phi]", "2"], 
     RowBox[{
      SuperscriptBox["r", "3"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      SubscriptBox["m", "s"]}]], "+", 
    RowBox[{"G", " ", 
     SubscriptBox["m", "s"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r", "-", 
            RowBox[{"r\[Earth]", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "-", 
            RowBox[{"r\[Earth]", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], " ", 
          SubscriptBox["M", "\[Earth]"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            SuperscriptBox["r\[Earth]", "2"], "-", 
            RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "-", 
            RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "-", 
           RowBox[{"r\[Mars]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "-", 
           RowBox[{"r\[Mars]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], " ", 
         SubscriptBox["M", "\[Mars]"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           SuperscriptBox["r\[Mars]", "2"], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "-", 
           RowBox[{"r\[Sun]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "-", 
           RowBox[{"r\[Sun]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], " ", 
         SubscriptBox["M", "\[Sun]"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           SuperscriptBox["r\[Sun]", "2"], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.743931479026169*^9, 3.743931491560276*^9}, 
   3.74393168658401*^9, 3.743932640358563*^9},
 CellLabel->
  "In[739]:=",ExpressionUUID->"885af61f-e6b7-4ed1-991d-c6925968d274"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["pr", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["p\[Theta]", "2"], 
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     SubscriptBox["m", "s"]}]], "+", 
   FractionBox[
    SuperscriptBox["p\[Phi]", "2"], 
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
     SubscriptBox["m", "s"]}]], "+", 
   RowBox[{"G", " ", 
    SubscriptBox["m", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r", "-", 
           RowBox[{"r\[Earth]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "-", 
           RowBox[{"r\[Earth]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], " ", 
         SubscriptBox["M", "\[Earth]"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           SuperscriptBox["r\[Earth]", "2"], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]\[Earth]", "]"}]}], "-", 
           RowBox[{"2", " ", "r", " ", "r\[Earth]", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]", "-", "\[Phi]\[Earth]"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]\[Earth]", "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"r\[Mars]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "-", 
          RowBox[{"r\[Mars]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], " ", 
        SubscriptBox["M", "\[Mars]"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["r\[Mars]", "2"], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]\[Mars]", "]"}]}], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Mars]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Mars]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Mars]", "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"r\[Sun]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "-", 
          RowBox[{"r\[Sun]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], " ", 
        SubscriptBox["M", "\[Sun]"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          SuperscriptBox["r\[Sun]", "2"], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]\[Sun]", "]"}]}], "-", 
          RowBox[{"2", " ", "r", " ", "r\[Sun]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "-", "\[Phi]\[Sun]"}], "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]\[Sun]", "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.743931501457837*^9, 3.7439316869485617`*^9, 
  3.743932306207513*^9, 3.743932646702524*^9},
 CellLabel->
  "Out[739]=",ExpressionUUID->"4ab86d5b-67af-4c72-91cc-5749f84e4016"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 1155},
WindowMargins->{{Automatic, 0}, {Automatic, -1}},
WindowStatusArea->None,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 170, 3, 67, "Section",ExpressionUUID->"37893b91-afb7-49fa-ab58-be1f8a17b3ab"],
Cell[753, 27, 1687, 45, 178, "Input",ExpressionUUID->"f54c1562-6c53-498d-a9d2-a2f3b5634afc"],
Cell[CellGroupData[{
Cell[2465, 76, 156, 3, 54, "Subsection",ExpressionUUID->"86c655a9-5947-445f-aa9a-af524ee708d1"],
Cell[2624, 81, 938, 25, 47, "Input",ExpressionUUID->"a83ee66e-9197-44b3-99a4-b0962f152dc6"],
Cell[CellGroupData[{
Cell[3587, 110, 795, 21, 50, "Input",ExpressionUUID->"013f59b4-bac5-4f27-86f0-463c3bcf0b09"],
Cell[4385, 133, 886, 22, 53, "Output",ExpressionUUID->"9414377b-9fce-43a1-8790-193d80bc65d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5308, 160, 223, 5, 30, "Input",ExpressionUUID->"797736b8-092d-4faa-a83f-75cc5d9f60ff"],
Cell[5534, 167, 1567, 41, 53, "Output",ExpressionUUID->"2db6a819-0e03-4d73-8a0b-bb23ca042193"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7150, 214, 337, 10, 54, "Subsection",ExpressionUUID->"7e3c859d-a21d-4db9-8ef9-1581253e7763"],
Cell[CellGroupData[{
Cell[7512, 228, 551, 12, 33, "Input",ExpressionUUID->"ce8f3667-eeb1-495b-9c27-e79b4af5c7f7"],
Cell[8066, 242, 864, 15, 34, "Output",ExpressionUUID->"d4ba0632-16c9-4638-948c-69df18623483"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8967, 262, 662, 13, 33, "Input",ExpressionUUID->"565426e4-4a52-4996-aac2-d3f4871de26a"],
Cell[9632, 277, 843, 16, 34, "Output",ExpressionUUID->"c956dfd6-c199-4abd-879d-822f85b48c23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10512, 298, 603, 12, 34, "Input",ExpressionUUID->"5a8f7e11-5745-4c26-9aeb-2d7f02dc7d7b"],
Cell[11118, 312, 866, 17, 35, "Output",ExpressionUUID->"5c10a0c0-b5a1-4a22-87b5-7ab70cc3aab3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12033, 335, 609, 19, 54, "Subsection",ExpressionUUID->"e88dc845-f86d-42ac-8b11-4c8c6f9e2b57"],
Cell[CellGroupData[{
Cell[12667, 358, 577, 14, 33, "Input",ExpressionUUID->"2977a948-9a8a-469f-97e2-2da01f34e60d"],
Cell[13247, 374, 849, 15, 51, "Output",ExpressionUUID->"160a4186-b304-4769-b2a7-17f1b28411f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14133, 394, 537, 14, 33, "Input",ExpressionUUID->"e9d9dae2-276f-41c8-9b3f-de582275719f"],
Cell[14673, 410, 790, 16, 53, "Output",ExpressionUUID->"cf9207aa-c9ee-4fd1-81b1-85021fa4f509"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15500, 431, 497, 13, 34, "Input",ExpressionUUID->"5d492020-480d-440a-8765-ba6fe2804286"],
Cell[16000, 446, 840, 18, 54, "Output",ExpressionUUID->"c335ce43-3592-4064-a729-1f5d11eca9b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16877, 469, 354, 9, 30, "Input",ExpressionUUID->"4cb8c8d2-3130-4411-8987-cbde8566485a"],
Cell[17234, 480, 991, 25, 57, "Output",ExpressionUUID->"8be514e4-6088-4e90-818f-fabdf50f002d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18262, 510, 223, 5, 30, "Input",ExpressionUUID->"3fc63d3d-fd32-4ebc-8886-3e0de9bb7f7e"],
Cell[18488, 517, 1375, 38, 57, "Output",ExpressionUUID->"ec6dab6d-66b2-48c6-a620-1d516c076e1b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19912, 561, 157, 3, 54, "Subsection",ExpressionUUID->"8c42dc22-09e2-4ae1-91d0-536c6bee8a27"],
Cell[CellGroupData[{
Cell[20094, 568, 760, 20, 34, "Input",ExpressionUUID->"43f39f59-b789-42b3-80fe-e184f9363fd0"],
Cell[20857, 590, 1425, 39, 57, "Output",ExpressionUUID->"7879e93f-e409-4235-8852-bebddcc6e9d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22319, 634, 500, 15, 45, "Subsubsection",ExpressionUUID->"6f039053-61c6-4389-b213-be2b34b462fd"],
Cell[22822, 651, 893, 22, 73, "Input",ExpressionUUID->"3f0034b7-7bbf-4f49-9847-0175fa391886"],
Cell[CellGroupData[{
Cell[23740, 677, 1488, 36, 115, "Input",ExpressionUUID->"d0fe34e6-51bc-43a1-8a38-615b1f40c272"],
Cell[25231, 715, 1065, 24, 42, "Output",ExpressionUUID->"6aba4dfe-7528-43c4-91ed-e854883ce376"]
}, Open  ]],
Cell[26311, 742, 1396, 38, 73, "Input",ExpressionUUID->"78e9a5fb-2ccf-4cec-98f3-e1acf11b8cd3"],
Cell[CellGroupData[{
Cell[27732, 784, 580, 12, 30, "Input",ExpressionUUID->"07713999-d911-4711-a649-dd5802499922"],
Cell[28315, 798, 1305, 29, 42, "Output",ExpressionUUID->"e7aa0906-7071-4f2b-bebf-cee409733ebb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29657, 832, 636, 13, 30, "Input",ExpressionUUID->"69e4f982-312e-4d3e-b60f-54d460b9fffd"],
Cell[30296, 847, 1225, 28, 42, "Output",ExpressionUUID->"df9ee551-49f6-42d7-94c8-da745807a875"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31558, 880, 551, 12, 30, "Input",ExpressionUUID->"eb4d7356-c626-488d-8374-c58fa1b907ce"],
Cell[32112, 894, 1165, 27, 42, "Output",ExpressionUUID->"fc833f80-c817-4073-b9b8-0a4ddfaeb41e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33326, 927, 157, 3, 45, "Subsubsection",ExpressionUUID->"922cd5dd-cf66-4890-b367-e88ca7bd7615"],
Cell[CellGroupData[{
Cell[33508, 934, 370, 9, 30, "Input",ExpressionUUID->"d0a9caa6-d1e8-41d4-81b9-72896d0491f7"],
Cell[33881, 945, 3114, 83, 181, "Output",ExpressionUUID->"b5ec0578-a233-4b0d-9330-104dcb1f8a2c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37056, 1035, 360, 6, 54, "Subsection",ExpressionUUID->"52e09240-1e4a-4258-9fac-becd1c694c18"],
Cell[CellGroupData[{
Cell[37441, 1045, 629, 13, 30, "Input",ExpressionUUID->"b61f0438-0d53-465d-83e3-9b04ab881a4d"],
Cell[38073, 1060, 755, 16, 51, "Output",ExpressionUUID->"7a79437f-18d1-4385-9d5f-908c6efbef1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38865, 1081, 575, 12, 30, "Input",ExpressionUUID->"78608010-2522-4733-809c-f5a854c80883"],
Cell[39443, 1095, 767, 17, 53, "Output",ExpressionUUID->"b5fe9365-f25b-43cd-b6f5-faa0b5df53eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40247, 1117, 524, 12, 30, "Input",ExpressionUUID->"4d86703d-3891-4f15-9245-c09423af1c6d"],
Cell[40774, 1131, 819, 19, 54, "Output",ExpressionUUID->"55bcd88d-1a4b-46e0-87f4-db128bf1b793"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41630, 1155, 504, 12, 30, "Input",ExpressionUUID->"8e90969f-6ccc-4176-b09c-2655e3eb0436"],
Cell[42137, 1169, 5487, 141, 160, "Output",ExpressionUUID->"6b44be71-28df-4994-9f56-6b811989f363"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47661, 1315, 521, 12, 30, "Input",ExpressionUUID->"10746d68-cea8-4577-8496-eaf6e9c5f3de"],
Cell[48185, 1329, 4792, 120, 160, "Output",ExpressionUUID->"62cac8bd-c7d6-4b81-9bf7-bf4cb67851a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53014, 1454, 515, 12, 30, "Input",ExpressionUUID->"01fc6d9f-85e4-465b-a57e-a432b018e915"],
Cell[53532, 1468, 3698, 91, 160, "Output",ExpressionUUID->"a72edb1e-31c4-4818-84f1-ef0947e9fef1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57267, 1564, 354, 12, 45, "Subsubsection",ExpressionUUID->"60675af6-ec50-4219-b5b9-c433e83b3f44"],
Cell[57624, 1578, 656, 17, 81, "Text",ExpressionUUID->"dbb7aa85-1cd0-4e13-96f2-a98476e159ae"],
Cell[58283, 1597, 238, 5, 35, "Text",ExpressionUUID->"1b73bfa4-f06a-40b8-9a90-03eb103612f2"],
Cell[CellGroupData[{
Cell[58546, 1606, 4282, 116, 155, "Input",ExpressionUUID->"2ef9b303-1fe7-457b-8037-cccd2c7804ed"],
Cell[62831, 1724, 3524, 87, 156, "Output",ExpressionUUID->"c07f3122-0ae2-4ee9-b3ef-e1d19a664660"]
}, Open  ]],
Cell[66370, 1814, 178, 3, 35, "Text",ExpressionUUID->"aa4f586b-264c-4e26-83e5-1ff9db22d32c"],
Cell[CellGroupData[{
Cell[66573, 1821, 4585, 108, 253, "Input",ExpressionUUID->"885af61f-e6b7-4ed1-991d-c6925968d274"],
Cell[71161, 1931, 4456, 107, 160, "Output",ExpressionUUID->"4ab86d5b-67af-4c72-91cc-5749f84e4016"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

